<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevNest AI - Coding Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Inter', system-ui, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
        }
        .mobile-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .message-user {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 18px 18px 4px 18px;
            margin-left: 20%;
            max-width: 90%;
        }
        .message-ai {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 18px 18px 18px 4px;
            margin-right: 20%;
            max-width: 90%;
        }
        .typing-indicator span {
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { 
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% { 
                transform: scale(1);
                opacity: 1;
            }
        }
        .mobile-tab {
            transition: all 0.2s ease;
        }
        .mobile-tab.active {
            background: #374151;
            border-color: #6366f1;
        }
        [x-cloak] { display: none !important; }
        
        /* Mobile First Design */
        @media (max-width: 768px) {
            .message-user, .message-ai {
                margin-left: 10% !important;
                margin-right: 10% !important;
                max-width: 85% !important;
                padding: 12px !important;
            }
            .mobile-text-sm {
                font-size: 14px !important;
            }
            .mobile-padding {
                padding: 12px !important;
            }
            .mobile-input {
                padding: 12px !important;
                font-size: 16px !important;
            }
        }
    </style>
</head>
<body class="bg-slate-900">
    <div x-data="{ 
        activeTab: 'chat',
        loggedIn: false,
        showLoginModal: false,
        username: 'Developer'
    }" class="mobile-container">
        
        <!-- Header - Mobile Optimized -->
        <div class="bg-slate-800 border-b border-slate-700 p-4 mobile-padding">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-code text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-white mobile-text-sm">DevNest AI</h1>
                        <p class="text-slate-400 text-xs">Coding Assistant</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <template x-if="!loggedIn">
                        <span class="text-xs text-orange-400 bg-orange-400/20 px-2 py-1 rounded">Guest</span>
                    </template>
                    <template x-if="loggedIn">
                        <span class="text-xs text-green-400 bg-green-400/20 px-2 py-1 rounded">
                            <i class="fas fa-user-check mr-1"></i>
                            <span x-text="username"></span>
                        </span>
                    </template>
                </div>
            </div>
        </div>

        <!-- Tabs - Mobile Navigation -->
        <div class="bg-slate-800 border-b border-slate-700 p-2 mobile-padding">
            <div class="flex space-x-1">
                <button 
                    @click="activeTab = 'chat'" 
                    :class="activeTab === 'chat' ? 'mobile-tab active text-white border-blue-500' : 'mobile-tab text-slate-400 border-transparent'"
                    class="flex-1 py-2 px-2 rounded-lg border text-sm font-medium transition mobile-text-sm"
                >
                    <i class="fas fa-comments mr-1"></i> Chat
                </button>
                <button 
                    @click="activeTab = 'history'" 
                    :class="activeTab === 'history' ? 'mobile-tab active text-white border-blue-500' : 'mobile-tab text-slate-400 border-transparent'"
                    class="flex-1 py-2 px-2 rounded-lg border text-sm font-medium transition mobile-text-sm"
                >
                    <i class="fas fa-history mr-1"></i> History
                </button>
                <button 
                    @click="activeTab = 'login'" 
                    :class="activeTab === 'login' ? 'mobile-tab active text-white border-blue-500' : 'mobile-tab text-slate-400 border-transparent'"
                    class="flex-1 py-2 px-2 rounded-lg border text-sm font-medium transition mobile-text-sm"
                >
                    <i class="fas fa-user mr-1"></i> Account
                </button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="flex-1 overflow-hidden">
            <!-- Chat Tab -->
            <template x-if="activeTab === 'chat'">
                <div class="h-full flex flex-col">
                    <!-- Messages Area -->
                    <div id="messages" class="flex-1 overflow-y-auto p-3 space-y-3 mobile-padding">
                        <!-- Welcome Message -->
                        <div class="message-ai">
                            <div class="flex items-start space-x-2">
                                <div class="w-8 h-8 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                                    <i class="fas fa-robot text-white text-xs"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="font-semibold text-blue-300 text-sm mb-1">DevNest AI</div>
                                    <div class="text-slate-200 text-sm leading-relaxed">
                                        <p class="mb-2">Hello! I'm your mobile coding assistant. I can help you with:</p>
                                        <ul class="list-disc list-inside space-y-1 text-slate-300 text-xs">
                                            <li>React, JavaScript, Python code</li>
                                            <li>Debugging and explanations</li>
                                            <li>Code optimization</li>
                                        </ul>
                                        <p class="mt-2 text-xs">Try the quick actions below! ðŸ‘‡</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions - Mobile Optimized -->
                    <div class="p-3 border-t border-slate-700 mobile-padding">
                        <div class="grid grid-cols-2 gap-2 mb-3">
                            <button onclick="quickAction('Create React component')" class="bg-slate-700/50 hover:bg-slate-600 p-2 rounded-lg transition text-xs text-center border border-slate-600">
                                <i class="fab fa-react text-blue-400 mb-1 block"></i>
                                React
                            </button>
                            <button onclick="quickAction('Python function')" class="bg-slate-700/50 hover:bg-slate-600 p-2 rounded-lg transition text-xs text-center border border-slate-600">
                                <i class="fab fa-python text-green-400 mb-1 block"></i>
                                Python
                            </button>
                            <button onclick="quickAction('CSS help')" class="bg-slate-700/50 hover:bg-slate-600 p-2 rounded-lg transition text-xs text-center border border-slate-600">
                                <i class="fab fa-css3-alt text-orange-400 mb-1 block"></i>
                                CSS
                            </button>
                            <button onclick="quickAction('JavaScript code')" class="bg-slate-700/50 hover:bg-slate-600 p-2 rounded-lg transition text-xs text-center border border-slate-600">
                                <i class="fab fa-js-square text-yellow-400 mb-1 block"></i>
                                JS
                            </button>
                        </div>

                        <!-- Input Area -->
                        <div class="flex space-x-2">
                            <div class="flex-1 relative">
                                <input 
                                    type="text" 
                                    id="messageInput"
                                    placeholder="Ask about code..."
                                    class="w-full bg-slate-700 border border-slate-600 rounded-xl px-4 py-3 mobile-input focus:outline-none focus:border-blue-500 text-sm"
                                >
                                <button onclick="sendMessage()" class="absolute right-2 top-1/2 transform -translate-y-1/2 w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-paper-plane text-white text-xs"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- History Tab -->
            <template x-if="activeTab === 'history'">
                <div class="h-full p-4 mobile-padding">
                    <template x-if="!loggedIn">
                        <div class="text-center h-full flex flex-col items-center justify-center">
                            <i class="fas fa-history text-4xl mb-4 text-slate-500"></i>
                            <h3 class="text-lg font-semibold text-slate-300 mb-2">Chat History</h3>
                            <p class="text-slate-400 text-sm mb-4">Login to save and view your chat history</p>
                            <button 
                                @click="activeTab = 'login'" 
                                class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition font-medium"
                            >
                                <i class="fas fa-sign-in-alt mr-2"></i>Go to Login
                            </button>
                        </div>
                    </template>
                    <template x-if="loggedIn">
                        <div class="space-y-3">
                            <h3 class="text-lg font-semibold text-white mb-4">Your Chat History</h3>
                            <div class="bg-slate-800 rounded-lg p-3 border border-slate-700">
                                <div class="font-medium text-white">React Components</div>
                                <div class="text-slate-400 text-sm">Yesterday - 5 messages</div>
                            </div>
                            <div class="bg-slate-800 rounded-lg p-3 border border-slate-700">
                                <div class="font-medium text-white">Python Debugging</div>
                                <div class="text-slate-400 text-sm">2 days ago - 3 messages</div>
                            </div>
                        </div>
                    </template>
                </div>
            </template>

            <!-- Login/Account Tab -->
            <template x-if="activeTab === 'login'">
                <div class="h-full p-4 mobile-padding">
                    <template x-if="!loggedIn">
                        <div class="text-center h-full flex flex-col justify-center">
                            <div class="w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6">
                                <i class="fas fa-user-lock text-white text-2xl"></i>
                            </div>
                            
                            <h3 class="text-xl font-bold text-white mb-2">Welcome to DevNest AI</h3>
                            <p class="text-slate-400 text-sm mb-6">Login to unlock all features</p>

                            <div class="space-y-4 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-slate-300 mb-2 text-left">Email</label>
                                    <input type="email" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-blue-500 mobile-input" placeholder="your@email.com">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-300 mb-2 text-left">Password</label>
                                    <input type="password" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-blue-500 mobile-input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                                </div>
                            </div>

                            <button 
                                @click="loggedIn = true; username = 'Mobile User';" 
                                class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-4 rounded-lg hover:from-blue-600 hover:to-purple-700 transition mb-4"
                            >
                                Sign In
                            </button>

                            <div class="text-center">
                                <button class="text-slate-400 hover:text-white text-sm transition">
                                    Don't have an account? <span class="text-blue-400 hover:text-blue-300">Sign up</span>
                                </button>
                            </div>
                        </div>
                    </template>

                    <template x-if="loggedIn">
                        <div class="space-y-6">
                            <div class="text-center">
                                <div class="w-16 h-16 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i class="fas fa-user-check text-white text-xl"></i>
                                </div>
                                <h3 class="text-xl font-bold text-white" x-text="username"></h3>
                                <p class="text-green-400 text-sm">âœ“ Logged In</p>
                            </div>

                            <div class="space-y-3">
                                <div class="bg-slate-800 rounded-lg p-4 border border-slate-700">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="font-medium text-white">Account Type</div>
                                            <div class="text-slate-400 text-sm">Free Plan</div>
                                        </div>
                                        <i class="fas fa-crown text-yellow-400"></i>
                                    </div>
                                </div>

                                <div class="bg-slate-800 rounded-lg p-4 border border-slate-700">
                                    <div class="font-medium text-white mb-2">Usage Stats</div>
                                    <div class="text-slate-400 text-sm space-y-1">
                                        <div class="flex justify-between">
                                            <span>Chats Today:</span>
                                            <span>12</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span>Code Generated:</span>
                                            <span>8 files</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button 
                                @click="loggedIn = false" 
                                class="w-full bg-red-500/20 hover:bg-red-500/30 text-red-400 border border-red-500/30 py-3 rounded-lg transition font-medium"
                            >
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout
                            </button>
                        </div>
                    </template>
                </div>
            </template>
        </div>
    </div>

    <script>
        function quickAction(prompt) {
            document.getElementById('messageInput').value = prompt;
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;

            addMessage('user', message);
            input.value = '';
            showTyping();

            try {
                const response = await fetch('https://devnest-ai.onrender.com/api/chat', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        message: message,
                        userId: 'mobile-user-' + Date.now()
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    hideTyping();
                    addMessage('ai', data.response || data.message);
                } else {
                    throw new Error('Backend unavailable');
                }

            } catch (error) {
                hideTyping();
                const responses = {
                    'react': `Mobile React component:\n\n\`\`\`jsx
function MobileComponent() {
  return (
    <div className="p-4">
      <h1 className="text-xl font-bold">Hello Mobile!</h1>
    </div>
  );
}
\`\`\``,
                    'python': `Python for mobile:\n\n\`\`\`python
def mobile_function():
    return "Hello from Python!"
\`\`\``,
                    'default': `I can help with mobile coding! Try:\n- React Native components\n- Responsive CSS\n- Mobile optimization\n- API integration`
                };
                
                const lowerMsg = message.toLowerCase();
                let responseText = responses.default;
                
                if (lowerMsg.includes('react')) responseText = responses.react;
                else if (lowerMsg.includes('python')) responseText = responses.python;
                
                addMessage('ai', responseText);
            }
        }

        function addMessage(sender, text) {
            const container = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            
            messageDiv.className = sender === 'user' ? 'message-user' : 'message-ai';
            messageDiv.innerHTML = `
                <div class="flex items-start space-x-2">
                    <div class="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${
                        sender === 'user' ? 'bg-gradient-to-r from-purple-500 to-pink-500' : 'bg-gradient-to-r from-green-400 to-blue-500'
                    }">
                        <i class="fas ${sender === 'user' ? 'fa-user' : 'fa-robot'} text-white text-xs"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="font-semibold mb-1 ${sender === 'user' ? 'text-purple-300' : 'text-blue-300'} text-sm">${sender === 'user' ? 'You' : 'DevNest AI'}</div>
                        <div class="text-slate-200 leading-relaxed whitespace-pre-wrap text-sm">${formatMessage(text)}</div>
                    </div>
                </div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function formatMessage(content) {
            return content
                .replace(/\`\`\`([^]+?)\`\`\`/g, '<div class="bg-slate-900 p-3 my-2 rounded-lg overflow-x-auto border border-slate-600"><code class="whitespace-pre text-xs">$1</code></div>')
                .replace(/\`(.*?)\`/g, '<code class="bg-slate-700 px-1.5 py-0.5 rounded text-xs border border-slate-600">$1</code>')
                .replace(/\n/g, '<br>');
        }

        function showTyping() {
            const container = document.getElementById('messages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typingIndicator';
            typingDiv.className = 'message-ai';
            typingDiv.innerHTML = `
                <div class="flex items-start space-x-2">
                    <div class="w-8 h-8 rounded-full flex items-center justify-center bg-gradient-to-r from-green-400 to-blue-500">
                        <i class="fas fa-robot text-white text-xs"></i>
                    </div>
                    <div>
                        <div class="font-semibold text-blue-300 text-sm mb-1">DevNest AI</div>
                        <div class="typing-indicator flex space-x-1">
                            <span class="w-1.5 h-1.5 bg-slate-400 rounded-full"></span>
                            <span class="w-1.5 h-1.5 bg-slate-400 rounded-full"></span>
                            <span class="w-1.5 h-1.5 bg-slate-400 rounded-full"></span>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }

        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMessage();
        });

        // Auto-focus on input
        setTimeout(() => {
            document.getElementById('messageInput').focus();
        }, 1000);
    </script>
</body>
</html>